<!-- Barra sticky de navegación del menú -->
<div
  id="menu-nav"
  class="sticky top-0 z-50 bg-fondo/90 backdrop-blur-md py-3 transition-shadow duration-300 rounded-2xl"
>
  <div
    id="menu-nav-scroll"
    class="flex flex-nowrap md:flex-wrap md:justify-center gap-3 max-w-4xl mx-auto px-4 overflow-x-auto scrollbar-hide scroll-smooth"
  >
    <a
      href="#hamburguesas"
      data-section="hamburguesas"
      class="menu-nav-btn shrink-0 px-5 py-2.5 bg-zinc-800 text-zinc-400 font-black uppercase tracking-wider rounded-full shadow-[0_0_15px_rgba(0,0,0,0.3)] hover:bg-amber-500 hover:text-black hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all duration-200 text-center no-underline border border-white/5 flex items-center justify-center text-sm whitespace-nowrap"
    >
      Hamburguesas
    </a>
    <a
      href="#hot-dogs"
      data-section="hot-dogs"
      class="menu-nav-btn shrink-0 px-5 py-2.5 bg-zinc-800 text-zinc-400 font-black uppercase tracking-wider rounded-full shadow-[0_0_15px_rgba(0,0,0,0.3)] hover:bg-amber-500 hover:text-black hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all duration-200 text-center no-underline border border-white/5 flex items-center justify-center text-sm whitespace-nowrap"
    >
      Hot Dogs
    </a>
    <a
      href="#bebidas"
      data-section="bebidas"
      class="menu-nav-btn shrink-0 px-5 py-2.5 bg-zinc-800 text-zinc-400 font-black uppercase tracking-wider rounded-full shadow-[0_0_15px_rgba(0,0,0,0.3)] hover:bg-amber-500 hover:text-black hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all duration-200 text-center no-underline border border-white/5 flex items-center justify-center text-sm whitespace-nowrap"
    >
      Bebidas
    </a>
    <a
      href="#otros"
      data-section="otros"
      class="menu-nav-btn shrink-0 px-5 py-2.5 bg-zinc-800 text-zinc-400 font-black uppercase tracking-wider rounded-full shadow-[0_0_15px_rgba(0,0,0,0.3)] hover:bg-amber-500 hover:text-black hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all duration-200 text-center no-underline border border-white/5 flex items-center justify-center text-sm whitespace-nowrap"
    >
      Otros
    </a>
    <a
      href="#extras"
      data-section="extras"
      class="menu-nav-btn shrink-0 px-5 py-2.5 bg-zinc-800 text-zinc-400 font-black uppercase tracking-wider rounded-full shadow-[0_0_15px_rgba(0,0,0,0.3)] hover:bg-amber-500 hover:text-black hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all duration-200 text-center no-underline border border-white/5 flex items-center justify-center text-sm whitespace-nowrap"
    >
      Extras
    </a>
  </div>
</div>

<style>
  /* Ocultar scrollbar pero mantener funcionalidad */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Sombra inferior cuando la barra está sticky */
  #menu-nav.is-stuck {
    box-shadow:
      0 4px 20px rgba(0, 0, 0, 0.5),
      0 1px 0 rgba(245, 158, 11, 0.15);
  }

  /* Estilo activo del botón */
  .menu-nav-btn.active {
    background-color: rgb(245 158 11) !important;
    color: black !important;
    box-shadow: 0 0 15px rgba(245, 158, 11, 0.4) !important;
    border-color: rgb(245 158 11) !important;
    transform: scale(1.05);
  }
</style>

<script>
  // === Sticky shadow effect ===
  const menuNav = document.getElementById("menu-nav");
  if (menuNav) {
    const observer = new IntersectionObserver(
      ([entry]) => {
        menuNav.classList.toggle("is-stuck", !entry.isIntersecting);
      },
      { threshold: 1, rootMargin: "-1px 0px 0px 0px" },
    );
    // Observamos un sentinel invisible arriba del nav
    const sentinel = document.createElement("div");
    sentinel.style.height = "1px";
    sentinel.style.marginBottom = "-1px";
    menuNav.parentElement?.insertBefore(sentinel, menuNav);
    observer.observe(sentinel);
  }

  // === Highlight active section on scroll ===
  const navButtons =
    document.querySelectorAll<HTMLAnchorElement>(".menu-nav-btn");
  const sections = document.querySelectorAll<HTMLElement>(".category-section");
  const scrollContainer = document.getElementById("menu-nav-scroll");

  function setActiveButton(sectionId: string) {
    navButtons.forEach((btn) => {
      const btnSection = btn.getAttribute("data-section");
      if (btnSection === sectionId) {
        btn.classList.add("active");
        // Auto-scroll del contenedor para que el botón activo sea visible
        if (scrollContainer) {
          const containerRect = scrollContainer.getBoundingClientRect();
          const btnRect = btn.getBoundingClientRect();
          const offsetLeft =
            btnRect.left - containerRect.left + scrollContainer.scrollLeft;
          scrollContainer.scrollTo({
            left: offsetLeft - containerRect.width / 2 + btnRect.width / 2,
            behavior: "smooth",
          });
        }
      } else {
        btn.classList.remove("active");
      }
    });
  }

  // Intersection Observer para detectar sección visible
  const sectionObserver = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute("id");
          if (id) setActiveButton(id);
        }
      });
    },
    {
      rootMargin: "-20% 0px -60% 0px",
      threshold: 0,
    },
  );

  sections.forEach((section) => sectionObserver.observe(section));

  // === Click en botones: scroll suave a la sección ===
  navButtons.forEach((btn) => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      const targetId = btn.getAttribute("data-section");
      if (!targetId) return;
      const targetSection = document.getElementById(targetId);
      if (targetSection) {
        const navHeight = menuNav?.offsetHeight ?? 0;
        const top =
          targetSection.getBoundingClientRect().top +
          window.scrollY -
          navHeight -
          12;
        window.scrollTo({ top, behavior: "smooth" });
        setActiveButton(targetId);
      }
    });
  });

  // === Drag horizontal en móvil/touch ===
  if (scrollContainer) {
    let isDown = false;
    let startX = 0;
    let scrollLeft = 0;

    scrollContainer.addEventListener("mousedown", (e) => {
      isDown = true;
      scrollContainer.style.cursor = "grabbing";
      startX = e.pageX - scrollContainer.offsetLeft;
      scrollLeft = scrollContainer.scrollLeft;
    });

    scrollContainer.addEventListener("mouseleave", () => {
      isDown = false;
      scrollContainer.style.cursor = "grab";
    });

    scrollContainer.addEventListener("mouseup", () => {
      isDown = false;
      scrollContainer.style.cursor = "grab";
    });

    scrollContainer.addEventListener("mousemove", (e) => {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - scrollContainer.offsetLeft;
      const walk = (x - startX) * 2;
      scrollContainer.scrollLeft = scrollLeft - walk;
    });

    // Cursor grab por defecto en móvil
    scrollContainer.style.cursor = "grab";
  }
</script>
